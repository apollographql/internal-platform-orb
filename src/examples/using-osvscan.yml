description: >
  An example of using osv-scanner in your pipelines to check for vulnerabilities in dependencies.

  osv-scanner checks for vulnerabilities in dependencies by comparing package versions in lockfiles
  to vulnerability databases. This job reports on those findings and additionally checks for related,
  existing pull requests in Github that appear to resolve the identified vulnerability.

  osv-scanner will recursively search for the following lockfiles to scan for vulnerabilities:
  buildscript-gradle.lockfile, Cargo.lock, composer.lock, conan.lock, Gemfile.lock, go.mod, gradle.lockfile,
  mix.lock, package-lock.json, packages.lock.json, Pipfile.lock, pnpm-lock.yaml, poetry.lock, pom.xml,
  pubspec.lock, requirements.txt, and yarn.lock. Additional lockfile formats may be added in the future.
  See https://github.com/google/osv-scanner#input-a-lockfile for the most up-to-date list.

  By default, this job will fail builds if 1 or more critical-severity vulnerabilities is identified
  in lockfiles. This behavior can be overridden via the fail-on-findings and min-fail-severity
  parameters.

usage:
  version: 2.1
  orbs:
    circleci-pde-orb: apollo-mdg-private/circleci-pde-orb@2.0.11
  workflows:
    check-for-vulns:
      jobs:
        - circleci-pde-orb/osvscan:
            context:
              - platform-docker-ro
              - github-orb
